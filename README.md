# Демков Михаил Кириллович 212

# ИДЗ №4. Вариант 8

## Условие задачи

В магазине работают три отдела, каждый отдел обслуживает один продавец. Покупатель, зайдя в магазин, делает покупки в
одном или нескольких произвольных отделах, обходя их в произвольном порядке. Если в выбранном отделе продавец не
свободен, покупатель становится в очередь и засыпает, пока продавец не освободится. Создать многопоточное приложение,
моделирующее рабочий день магазина.

# Задание решено на 8 баллов

## Решение на 4 балла:

**Клиенты и серверы** – рабочий способ взаимодействия неравноправных потоков. Клиентский поток запрашивает сервер и ждет
ответа. Серверный поток ожидает запроса от клиента, затем действует в соответствии с поступившим запросом. В данной
программе клиентским потоком выступает покупатель, а серверным - продавец. (статья с хабра)

По условию потоков продавцов всегда 3. Количество потоков покупателей может выставляться вручную(через консоль).
Количество отделов в плане у каждого покупателя может задаваться вручную и генерироваться случайным образом(консоль).

**Ввод данных реализован с консоли**

## Решение на 5 баллов:

Сценарий, описывающий одновременное поведение представленных в условии задания сущностей в терминах предметной области:

* **Магазин открывается**
* **Каждый продавец открывает свой отдел и ждет покупателей**
* **Покупатели приходят в магазин со своим списком покупок**
* **Каждый покупатель встает в очередь в нужный отдел, не мешая другим**
* **Как только продавец заканчивает работу с предыдущим клиентом, он принимает следующего, и касса блокируется**
* **Если покупатель обошел все нужные отделы, он покидает магазин**
* **Если покупателей больше нет, то продавец заканчивает работу**
* **Магазин закрывается**

## Решение на 6 баллов:

Обобщенный алгоритм, используемый при реализации программы исходного словесного сценария:

_Реализован ввод данных из командной строки_

* **Начало работы программы (main.cpp)**
* **Создание 3-х потоков продавцов + mutex**
* **3 Потока работают параллельно, пока существует хотя бы 1 поток покупателя**
* **Поток продавцов ожидает, когда к нему придет значение**
* **Поток обрабатывает значение покупателя**
* **Создание n потоков покупателей**
* **n потоков работает параллельно, пока у покупателя в плане есть хотя бы 1 номер отдела**
* **lock mutex i - покупатель проходит к продавцу или ждёт в очереди**
* **і-ым значением массива ставит вместо nullptr себя (ставит себя в очередь)**
* **Пока продавец не поставит опять nullptr (освобождит кассу), покупатель ждёт**
* **unlock mutex і - пускает следующего клиента**
* **Если план закончился - завершается поток**
* **Join потоков покупателей и продавцов**
* **Завершение работы программы**

## Решение на 7 баллов:

Реализован _ввод/вывод_ данных из файла. Есть примеры файлов с входными и выходными данными. Результат работы программы
отображается как в консоли, так и в файле. **Таким образом расширен функционал ввода данных из командной строки**

## Решение на 8 баллов:

Реализована генерация случайных данных. Есть примеры с входными и выходными данными. **Таким образом расширен функционал
ввода данных из командной строки**